# 暗黙的なムーブを簡略化
* cpp23[meta cpp]

## 概要

C++20の暗黙ムーブ仕様においては、暗黙ムーブ可能なもの（関数ローカルのオブジェクト/右辺値参照）が`return`文においてコピーされる場合に、可能ならば暗黙的にムーブして戻り値を構築するものだった。しかし、暗黙ムーブ可能なものを返しており`return`文でコピーが起こらない場合で、暗黙ムーブを行うことが適切な場合がまだ存在していた。

C++23ではその様なものを暗黙ムーブの対象に含めるために暗黙ムーブ仕様の調整が行われた。

```cpp
// 例示用のムーブ可能な型
struct Widget {
  Widget(Widget&&);
};

// Widgetの右辺値から構築可能な型
struct RRefTaker {
  RRefTaker(Widget&&);
};


auto example1(Widget w) -> RRefTaker {
  // ローカル変数の暗黙ムーブ
  return w;  // ok、C++11(CWG1579)から
}

auto example2(Widget&& w) -> RRefTaker {
  // ローカル右辺値参照の暗黙ムーブ
  return w;  // ok、C++20(P0527)から
}

auto example3(Widget&& w) -> Widget&& {
  // ローカル右辺値参照の暗黙ムーブ（戻り値型が参照型の場合）
  return w;  // C++20ではng、C++23からok
}

// 右辺値修飾変換演算子を持つ型
struct Jeff {
  operator int&() &&;
};

auto example4(Jeff x) -> int& {
  // ローカル変数の暗黙ムーブ（戻り値型が参照型の場合）
  return x;  // C++20ではng、C++23からok
}
```

また同時に、C++11で導入されて以降少しづつその対象（暗黙ムーブが起こる場合および起こる場所）を拡大してきたことで複雑化していた暗黙ムーブ仕様が整理され、その仕様と実装がかなり単純化された。

## 仕様
(執筆中)

## 例
(執筆中)

```cpp example
// (ここには、言語機能の使い方を解説するための、サンプルコードを記述します。)
// (インクルードとmain()関数を含む、実行可能なサンプルコードを記述してください。そのようなコードブロックにはexampleタグを付けます。)

#include <iostream>

int main()
{
  int variable = 0;
  std::cout << variable << std::endl;
}
```
* variable[color ff0000]

(コードブロック中の識別子に、文字色を付ける例です。)

### 出力
```
0
```

(ここには、サンプルコードの実行結果を記述します。何も出力がない場合は、項目を削除せず、空の出力にしてください。)  
(実行結果が処理系・実行環境によって異なる場合は、項目名を「出力例」に変更し、可能であればその理由も併記してください。)


## この機能が必要になった背景・経緯
(執筆中)

## 検討されたほかの選択肢
(執筆中)

## 関連項目
(執筆中)

## 参照

- [P2266R3 Simpler implicit move](https://wg21.link/p2266r3)
